# Global financial markets and investments

options(scipen = 10)
library(tidyverse)


# Semaine 1---------------------------------------------------------------------

## Quiz 1----

# Q1
x <- 5000
i <- 0.08
an <- 5

x_5 <- x*(1+i)**an

# Q2

V1 <- 100000
i <- 0.05
an <- 10

V0 <- V1 / (1+i)**an

# Q3

V1 <- 23000
an <- 2
i <- 0.04

V0 <- V1 / ((1+i)**an)

25000 / (1.04**3)

# Q4


x <- 8000
i <- 0.05
an <- 5

x_5_3 <- 9000*(1+0.02)**2 *(1+0.04)**3
x_5_2 <- 8000*(1+0.05)**5
x_5_1 <- 9000*(1+0.03)**5

x_5 <- x*(1+i)**an

## Quiz 2-----

# Q1 

x1<- 10000 * 1.04**13
x2 <- 1000 * (( 1.04**13 - 1) / 0.04)


# Q2
q2 <- 5000 * (( 1.06**20 - 1) / 0.06)

# Q3

Q3_1 <- 500 * (( -1.005**-36 + 1) / 0.005)
Q3_2 <- 600 * ((- 1.005**-24 + 1) / 0.005)
Q3_3 <- 350 * ((- 1.005**-48 + 1) / 0.005)


# Q4
Q4_1 <- 450000 / ((-(1 + 0.035/12)**-(30*12) + 1) / (0.035/12))
Q4_2 <- 450000 / ((-(1 + .03/12)**-(20*12) + 1) / (.03/12))
Q4_3 <- 450000 / ((-(1 + .028/12)**-(15*12) + 1) / (0.028 / 12))


## Quiz 3----

# Q2
Q2 <- ((1+0.08/4)**4 - 1)*100

# Q3
Q3 <- ((1+0.08/4)**2 - 1)*100

# Q4
Q4 <- ((1+0.08/12)**6 - 1)*100

# Q5
Q5 <- ((1+0.06/2)**(5*2) - 1)*100

# Q6
Q6_1 <- ((1+0.06/12)**(12) - 1)*100
Q6_2 <- ((1+0.07/4)**(4) - 1)*100
Q6_3 <- ((1+0.065/2)**(2) - 1)*100
Q6_4 <- ((1+0.02)**(4) - 1)*100

# Q7

(1+0.08/4)**(3/4) - 1

## Quiz 4----

# Q1
10000 / 0.05

# Q2
12000 / 0.05

# Q3
2000 / (0.04-0.02)

# Q4 => find le pr√©sent value au each cash flow
Q4_1 <- 150000 

adf <- (1- ((1 + 0.00125)**36 / (1+.005)**36)) / (0.005 - 0.00125)
Q4_2 <- 100000 + 1250 * adf
Q4_3 <- 750/0.005
Q4_4 <- 25000 + 500 / (0.005 - 0.00125)


# Semaine 1---------------------------------------------------------------------

10000/9492.17 - 1

((1000000 / 455000)**(1/40) - 1)*2 # Yield -> annuel 

v1 <- 1000
rc <- 12/100
r <- 5.35/100

coupon <- 1000 * rc /2
adf <- (1 - 1/(1 + 0.0535 / 2 )**4) / (0.0535/2)

v0 <- coupon * adf + 1000 / ((1+0.0535/2)**4)


## Quiz 1----

# Q2
((1000 / 744.09)**(1/5) - 1)

# Q3
coupon <- (1000 * 10 / 100)/4
adf_c <-  (1 - 1 / ((1+0.08/4)**(20*4))) / (1+0.08 / 4)

coupon * adf_c + 1000 / ((1+0.08/4)**(20*4))

# Q4 ?

(80 + ((1000 - 1200) / 20)) / ((1000 + 1200) /2)

# Q5
(60 + ((1000 - 1000) / 10)) / ((1000 + 1000) /2) * 2 # Car bi annuel

# Q6




