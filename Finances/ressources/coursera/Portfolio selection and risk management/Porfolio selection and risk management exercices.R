# Portfolio selection and risk management----


# Semaine 2---------------------------------------------------------------------

## Part 2-----
ew <- 0.1*4.5 + 0.4*5.5 + 0.3 * 4 + 0.2*(-1)
et <- 0.1*6 + 0.4*7.5 + 0.3*2 + 0.2 * (-3)

sdw <- (0.1 * (4.5 - ew)**2 + 0.4 * (5.5 - ew)**2 + 0.3 * (4 - ew)**2 + 0.2*(-1 - ew)**2)**0.5
sdt <- (0.1* (6-et)**2 + 0.4*(7.5-et)**2 + 0.3*(2-et)**2 + 0.2 * (-3 - et)**2)**0.5

covwt <- 0.1* (4.5 - ew)*(6-et) + 0.4*(5.5 - ew)*(7.5-et) + 0.3*(4 - ew)*(2-et) + 0.2 * (-1 - ew)*(-3 - et)
corrwt <- covwt / (sdw * sdt)

varp <- (0.5*sdw)**2 + (0.5*sdt)**2 + 2 * 0.5*0.5*covwt
sdp <- varp**0.5


### Quiz2----

ea <- 0.3*(-20) + 0.4 * 5 + 0.3 * 40
sda <- (0.3*(-20 - ea)**2 + 0.4 * (5-ea)**2 + 0.3 * (40-ea)**2)**0.5

eb <- 0.3*(-5) + 0.4 * 10 + 0.3 * 15
sdb <- (0.3*(-5 - eb)**2 + 0.4 * (10-eb)**2 + 0.3 * (15-eb)**2)**0.5

ec <- 0.3*(5) + 0.4 * 3 + 0.3 * 2
sdc <- (0.3*(5 - ec)**2 + 0.4 * (3-ec)**2 + 0.3 * (2-ec)**2)**0.5


ep <- 0.4 * ea + 0.2 * eb + 0.4 * ec

covab <- 0.3*(-20 - ea)*(-5 - eb) + 0.4 * (5-ea)*(10-eb) + 0.3 * (40-ea)*(15-eb)
covac <- 0.3*(-20 - ea)*(5 - ec) + 0.4 * (5-ea)*(3-ec) + 0.3 * (40-ea)*(2-ec)
covbc <- 0.3*(5 - ec)*(-5 - eb) + 0.4 * (3-ec)*(10-eb) + 0.3 * (2-ec)*(15-eb)

corrab <- covab / (sda * sdb)
corrac <- covac / (sda * sdc)
corrbc <- covbc / (sdb * sdc)


ep_ac <- (ea + ec) / 2

sdp_ac <- ((0.5*sda)**2 + (0.5*sdc)**2 + 2 * 0.5 * 0.5 * covac)**0.5

ep_ab <- 0.6*ea + 0.4*eb

sdp_ab <- ((0.6*sda)**2 + (0.4*sdb)**2 + 2 * 0.6 * 0.4 * covab)**0.5

## Part 3-----

